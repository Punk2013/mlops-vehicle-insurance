# MLOPS Vehicle Insurance estimator
Рализация конвейера MLOPS для задачи бинарной классификации наличия страхового случая у машин Эфиопии. 

Различные версии моделей сохранятся в `models/`. В cache сохранаяется добавленные из потока батчи данных `train_data`, данные о позиции в потоке `rows_read.txt`, сводка о качестве данных `data_quality.pkl`, которая выводится через режим `summary`(см. ниже), обученное на добавленных батчах преобразование `transformer.pkl`, которое применяется после базовой очистки данных.

## Использование
### Дообучение следующим батчем данных из потока(по умолчанию data/motor_data11-14lats.csv):
```
python main.py -mode update
```
Нужно выполнить многократно. Для изменения размера батча необходимо изменить default_batchsize в main.py.

### Применение обученной модели к внешним данным
```
python main.py -mode inference -file ПУТЬ_К_ФАЙЛУ
```
### Сводка
```
python main.py -mode summary
```
Выводит data quality и проводит кросс-валидацию на добавленных данных из потока.

## CI/CD

Был создан CI/CD рабочий процесс через Github Actions. Рабочий процесс запускает задачу при push, pull request, по расписанию и по нажатию соответствующей кнопки в разделе Actions. Задача выполняет итерации дообучения, количество которых можно указать в `.github/workflows/main.yml`. Происходит сохраниние `models/` и `cache/` в качестве артефактов для продолжения обучения следующими запусками процесса. Это позволяет полностью перенести процесс обучения в удаленную систему и продолжать обучение после изменений модели и других частей конвейера.

# Прогресс задания 1:
## 1. Сбор данных (3–10 баллов):

(a) Обязательная часть:

i. Функционал сбора потоковых данных: разделение исходного набора на
батчи и эмуляция потока (1 балл); :white_check_mark:

ii. Разработка хранилища сырых данных: файловая система (1 балл) или
БД (2 балла); :white_check_mark:

iii. Расчет метапараметров: (1-2 балла). :white_check_mark:

(b) Дополнительные баллы:

i. Создание конфигурационного файла (.py или YAML/JSON/TOML/XML)
с гиперпараметрами сбора (1 балл);

ii. Интеграция с несколькими источниками данных (2 балла);

iii. Система логирования (с использованием библиотек или вручную) и
обработки ошибок при сборе данных (1-2 балла). :ballot_box_with_check:(debug info)

## 2. Анализ данных (2–10 баллов):

(a) Обязательная часть:

i. Оценка и хранение показателей качества данных (data quality) (1-2
балла); :white_check_mark:

ii. Базовая очистка данных на основе порогов допустимых значений ка-
чества (1 балл). :white_check_mark:

(b) Дополнительные баллы:

i. Автоматический EDA (1-2 балла);

ii. Добавление Feature Engineering (1-2 балла); :ballot_box_with_check:(преобразовние дат в числовые признаки день, месяц, год)

iii. Генерация отчетов о качестве данных (1 балла); :white_check_mark:(summary)

iv. Мониторинг и обработка ситуаций data drift (1-2 балл).

## 3. Подготовка данных (входит в pipeline построения модели) (0–5 бал-
лов):

(a) Обязательная часть зависит от используемой модели ML:

i. Обработка пропусков (0-1 балл); :white_check_mark:

ii. Обработка категориальных переменных (0-1 балл); :white_check_mark:

iii. Обработка числовых переменных (0-1 балл). :white_check_mark:

(b) Дополнительные баллы:

i. Создание нескольких вариантов предобработки с дальнейшим перебо-
ром при поиске лучшей модели (1-2 балла).

## 4. Обучение/дообучение модели (входит в pipeline построения модели)
(1–5 баллов):

(a) Обязательная часть: построение модели (LR, kNN или дерево решений) (1
балл). :white_check_mark:

(b) Дополнительные баллы:

4i. Реализация дообучения предыдущей модели (без обучения модели с
нуля) (1-2 балла); :white_check_mark:(написан метод, но не используется)

ii. Разработка нескольких моделей с различной устойчивостью к входным
данным (1-2 балла).

## 5. Валидация модели (2–10 баллов):

(a) Обязательная часть:

i. Оценка качества модели/моделей (hold-out/CV/TimeSeriesCV) (1-3
балла); :white_check_mark:

ii. Разработка хранилища версий моделей и контроль качества (1-2 бал-
ла). :white_check_mark:

(b) Дополнительные баллы:

i. Интерпретация прогнозов (визуализация структуры дерева, оценка ко-
эффициентов LR, демонстрация ближайших соседей, LIME, SHAP) (1-
3 балла);

ii. Мониторинг и обработка ситуаций model drift (1–2 балла).

## 6. Обслуживание модели (1–6 баллов):

(a) Обязательная часть: выбор и упаковка (сериализация) финальной модели
(или нескольких) (1-2 балла); :white_check_mark:

(b) Дополнительные баллы:

i. Мониторинг производительности (времени применения/памяти) (1-2
балла);

ii. Обеспечение гибкого прогноза на основе данных (выбор модели при
разреженных данных или аномальных значениях) (1-2 балла).

## 7. Управление программой (3–11 баллов):

(a) Обязательная часть:

i. Создание скрипта управления конвейером и обработка запросов
(Inference, Update, Summary) (2 балла); :white_check_mark:

ii. Написание документации к программной реализации (README и
requirements) (1 балл). :white_check_mark:

(b) Дополнительные баллы:

i. Построение расширенного отчета (dashboard) о работе системы (1-2
балла);

ii. Создание конфигурационного файла параметров всех компонентов си-
стемы (размер батча, допустимое число пропусков, тип валидации и
т.д.) (1-2 балла);

iii. Создание Meta Learning модели: оценка влияющих гиперпараметров и
динамика метрик качества моделей и данных (2 балла).

iv. Построение архитектуры на основе паттернов проектирования (напри-
мер, MVC (model/view/controller)) ПО (1-2 балла).

# Прогресс задания 2
## 1. Функциональность workflow (3-8 баллов):

(a) Обязательная часть:

i. Автоматическое выполнение при push/pull request (1 балл); :white_check_mark:

ii. Корректная установка окружения (1 балл); :white_check_mark:

iii. Успешное обучение модели (1 балл); :white_check_mark:

(b) Дополнительная часть:

i. Управление инкрементальным обучением изнутри YAML-файла (1
балл); :white_check_mark:

ii. Настройка CI/CD с инкрементальным дообучением на основе преды-
дущих запусков по расписанию (3 балла); :white_check_mark:

iii. Добавление тестов ML-системы с помощью средств CI/CD (1 балл);

iv. Иное расширение workflow (интеграция с базами данных, запуск пара-
лелльных jobs, и т.д.);

## 2. Управлением артефактами (1-6 баллов):

(a) Обязательная часть: Сохранение логов обучения моделей (1 балл); :white_check_mark:

(b) Дополнительная часть:

i. Сохранение сериализованной модели, допускающей запуск извне (1
балл); :white_check_mark:

ii. Сохранение модели сборщика данных, допускающего загрузку акту-
альных данных извне (1 балл); :white_check_mark:

iii. Сохранение dashboard истории обучения или запуск онлайн-сервиса на
платформе GitHub Actions (3 балла);

## 3. Документирование проекта. Обязательная часть (2 балла):

2(a) Добавление раздела в README с инструкциями по развертыванию (1
балл); :white_check_mark:

(b) Текстовое описание и аргументация выбранного подхода (1 балл); :white_check_mark:
